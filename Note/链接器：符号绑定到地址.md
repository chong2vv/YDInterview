# 链接器：符号如何绑定到地址上

## 链接器的主要作用

链接器的主要作用就是将符号绑定到地址上。

## iOS开发为什么使用的是编译器

iOS编写的代码是先用编译器把代码编译成机器码，然后直接在CPU上执行机器码的。没有使用解释器运行代码是因为速度不够快，因为解释器会在运行时解释代码，获取一段代码后就会将其翻译成目标代码（就是字节码），然后一句一句的执行目标代码。也就是说解释器是在运行时才去解析代码，这就比编译器生成一份完整的机器码再去执行的效率要低。

解释器可以在运行时去执行代码，说明它具有动态性，程序运行后能够随时通过增加和更新代码来改变程序的逻辑。也就是说，你写的程序跑起来后不用重新启动，就可以看到代码修改后的效果，这样就缩短了调试周期。程序发布后，你还可以随时修复问题或者增加新功能，用户也不用一定要等到发布新版本后才可以升级使用。所以说，使用解释器可以帮我们缩短整个程序的开发周期和功能更新周期。

编译器和解释器执行代码的特点，我们可以概括如下：

- 采用编译器生成机器码执行的好处是效率高，缺点是调试周期长。
- 解释器执行的好处是编写调试方便，缺点是执行效率低。

## iOS开发使用的是什么编译器

现在苹果公司使用的编译器是 LLVM，相比于 Xcode 5 版本前使用的 GCC，编译速度提高了 3 倍。同时，苹果公司也反过来主导了 LLVM 的发展，让 LLVM 可以针对苹果公司的硬件进行更多的优化。

总结来说，LLVM 是编译器工具链技术的一个集合。而其中的 lld 项目，就是内置链接器。编译器会对每个文件进行编译，生成 Mach-O（可执行文件）；链接器会将项目中的多个 Mach-O 文件合并成一个。总结来说，LLVM 是编译器工具链技术的一个集合。而其中的 lld 项目，就是内置链接器。编译器会对每个文件进行编译，生成 Mach-O（可执行文件）；链接器会将项目中的多个 Mach-O 文件合并成一个。

LLVM编译的主要过程：

- 首先，你写好代码后，LLVM 会预处理你的代码，比如把宏嵌入到对应的位置。
- 预处理完后，LLVM 会对代码进行词法分析和语法分析，生成 AST 。AST 是抽象语法树，结构上比代码更精简，遍历起来更快，所以使用 AST 能够更快速地进行静态检查，同时还能更快地生成 IR（中间表示）。
- 最后 AST 会生成 IR，IR 是一种更接近机器码的语言，区别在于和平台无关，通过 IR 可以生成多份适合不同平台的机器码。对于 iOS 系统，IR 生成的可执行文件就是 Mach-O。

![编译过程](../Resource/03e511d5cc6eb12889d882d6e705ac63.png)